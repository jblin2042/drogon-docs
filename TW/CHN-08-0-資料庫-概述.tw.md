[English](/ENG/ENG-08-0-Database-General)

# 概述

**Drogon** 內建資料庫讀寫引擎，對資料庫連線操作採用 non-blocking I/O 技術實作，從底層到上層介面皆為高效能非阻塞非同步方式，確保 Drogon 具備高併發效能。目前支援 PostgreSQL 與 MySQL 資料庫，若要使用資料庫，開發環境必須先安裝相應資料庫開發套件，Drogon 會自動偵測這些函式庫的標頭與連結檔，並編譯相關部分。資料庫開發環境準備請參考[安裝資料庫環境](/CHN/CHN-02-安裝#数据库环境)。

**Drogon** 為支援輕量級應用，也支援 sqlite3 資料庫，透過執行緒池實作非同步介面，與前述資料庫介面統一。

### 客戶端

Drogon 資料庫基本操作物件為 `DbClient`（抽象類別，使用者持有的是 `DbClient` 型別的智慧指標，具體型別取決於建構介面），不同於一般資料庫介面，此物件不代表單一資料庫連線，內部可包含一個或多個連線，可視為**連線池物件**。

`DbClient` 同時提供同步與非同步介面，非同步介面也支援阻塞與非阻塞模式。建議多用非同步非阻塞模式，能更好配合 Drogon 非同步框架並提升併發效能。

通常，呼叫非同步介面時，DbClient 會在管理的空閒連線中隨機選取一個執行查詢，待結果回傳時，`DbClient` 會處理資料並透過回呼函式物件回傳給呼叫方；若呼叫時無空閒連線，執行內容會被暫存，待有連線完成 SQL 請求後，會依序取出暫存命令執行。

`DbClient` 詳細內容請見[DbClient](/CHN/CHN-08-1-数据库-DbClient)。

### 交易（Transaction）

可由 `DbClient` 產生交易物件以支援交易操作，交易物件除多出一個 `rollback()` 介面外，其餘基本與 `DbClient` 一致，交易物件類別為 `Transaction`，詳情請參閱[交易](/CHN/CHN-08-2-数据库-事务)。

### ORM

Drogon 也支援 **ORM**，使用者可透過 drogon_ctl 讀取資料庫中的資料表並產生對應的 model 類別原始碼，然後透過 `Mapper<MODEL>` 類模板完成物件的資料庫操作，為標準資料操作提供簡便介面，讓使用者無需自行撰寫 SQL 即可完成資料表的新增、刪除、修改、查詢。ORM 詳情請參閱[ORM](/CHN/CHN-08-3-数据库-ORM)。

# 下一步：[DbClient](/CHN/CHN-08-1-数据库-DbClient)
